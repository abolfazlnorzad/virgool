(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{I0Fw:function(t,e,n){"use strict";n.r(e);var o=n("pvRw"),a=n("Q1Rp"),i=n("LvDl"),r={name:"Create",components:{TipTap:a.a},setup:function(t,e){var n=e.root,a=e.refs,r=Object(o.d)(""),c=Object(o.d)(""),s=Object(o.d)("post"),l=Object(o.d)("/api/posts/create"),u=Object(o.c)({saved:!1,error:!1}),d=n.$route.params.link;d&&(s.value="patch",l.value="/api/drafts/"+d,axios.get("/api/drafts/".concat(d)).then((function(t){var e=t.data;r.value=e.title,c.value=e.content,a.tiptap.editor.setContent(e.content)})).catch((function(t){var e=t.response;404===e.status&&n.$router.push({name:"not-found"}),403===e.status&&n.$router.push({name:"access-denied"})})));var v=Object(i.debounce)((function(){p().then((function(t){var e=t.data;"post"===s.value&&(history.replaceState({}," ",e.link),l.value="/api".concat(e.link)),s.value="patch",u.saved=!0})).catch((function(){u.error=!0}))}),2e3),p=function(){return n.$store.dispatch("draft/saveDraft",{requestType:s.value,requestURI:l.value,title:r.value,content:c.value})};return{saveDraft:function(){v.cancel(),p().then((function(t){var e=t.data,o=e.link?e.link:"/drafts/".concat(n.$route.params.link);n.$router.push("".concat(o,"/save"))}))},showDraftSave:Object(o.a)((function(){return r.value&&c.value})),title:r,requestType:s,content:c,requestURI:l,snackbar:u,changeDraft:v,setContent:function(t){c.value=t}}}},c=(n("k9I8"),n("KHd+")),s=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",[n("v-row",[n("v-col",[n("v-form",{staticClass:"editor"},[n("v-text-field",{attrs:{placeholder:"عنوان متن"},on:{input:t.changeDraft},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),t._v(" "),n("tip-tap",{ref:"tiptap",on:{input:t.changeDraft},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),t._v(" "),t.showDraftSave?n("v-btn",{attrs:{color:"info"},on:{click:function(e){return e.stopPropagation(),t.saveDraft(e)}}},[t._v("\n                دخیره ی پیش نویس\n            ")]):t._e()],1)],1),t._v(" "),n("v-snackbar",{attrs:{color:"primary",timeout:"3000"},model:{value:t.snackbar.saved,callback:function(e){t.$set(t.snackbar,"saved",e)},expression:"snackbar.saved"}},[t._v("\n        پیش نویس شما با موفقیت ذخیره گردید\n        "),n("v-btn",{attrs:{text:""},on:{click:function(e){e.stopPropagation(),t.snackbar.saved=!1}}},[t._v("\n            بستن\n        ")])],1),t._v(" "),n("v-snackbar",{attrs:{color:"error",timeout:"0"},model:{value:t.snackbar.error,callback:function(e){t.$set(t.snackbar,"error",e)},expression:"snackbar.error"}},[t._v("\n        پیش نویس شما با موفقیت ایجاد نشد\n        "),n("v-btn",{attrs:{text:""},on:{click:function(e){e.stopPropagation(),t.snackbar.error=!1}}},[t._v("\n            بستن\n        ")])],1)],1)}),[],!1,null,null,null);e.default=s.exports},Q1Rp:function(t,e,n){"use strict";var o=n("pvRw"),a=n("zUJn"),i=n("8j27"),r=n("ksP6"),c=n.n(r),s=(n("Hj/Q"),{name:"DropZone",components:{vueDropzone:c.a},setup:function(t,e){var n=e.emit,a=Object(o.d)({url:"/api/upload-post-image",maxFile:1,headers:{"X-CSRF-TOKEN":window.csrf_token}}),i=Object(o.d)(!1),r=Object(o.d)(null),c=Object(o.d)(!1);return{dropzoneOptions:a,imageModal:i,imageCommand:c,showModal:function(t){i.value=!0,c.value=t},upload:function(t,e){var o={imageCommand:c.value,attrs:{src:e.data}};n("image",o),i.value=!1,c.value=null,r.value.removeFile(t)},dropzone:r}}}),l=n("KHd+"),u={name:"TipTap",components:{DropZone:Object(l.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{"max-width":"360px"},model:{value:t.imageModal,callback:function(e){t.imageModal=e},expression:"imageModal"}},[n("v-card",[n("v-card-title",[t._v("عکس خود را اپلود کنین")]),t._v(" "),n("vue-dropzone",{ref:"dropzone",attrs:{id:"dropzone",options:t.dropzoneOptions},on:{"vdropzone-success":t.upload}}),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{on:{click:function(e){t.imageModal=!1}}},[t._v("\n                بستن\n            ")])],1)],1)],1)}),[],!1,null,"1db4729e",null).exports,EditorFloatingMenu:a.c,EditorContent:a.b,EditorMenuBubble:a.d},props:{value:{type:String,default:""}},setup:function(t,e){var n=e.emit,r=Object(o.d)(null),c=Object(o.d)([{active:"italic",command:"italic",icon:"format-italic",tooltip:"ایتالیک",context:{}},{active:"bold",command:"bold",icon:"format-bold",tooltip:"درشت",context:{}}]),s=Object(o.d)([{active:"heading",command:"heading",icon:"format-header-1",tooltip:"هدر 1",context:{level:1}},{active:"heading",command:"heading",icon:"format-header-2",tooltip:"هدر 2",context:{level:2}},{active:"heading",command:"heading",icon:"format-header-3",tooltip:"هدر 3",context:{level:3}}]);return{editor:Object(o.d)(new a.a({extensions:[new i.a,new i.e,new i.f,new i.i,new i.n,new i.c,new i.m,new i.q,new i.r,new i.b,new i.d,new i.j,new i.k,new i.l,new i.p,new i.s,new i.h,new i.g({level:[1,2,3]}),new i.o({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",emptyNodeText:"هرچیزی که میخای بنویس ...",showOnlyWhenEditable:!0,showOnlyCurrent:!0})],content:t.value,onUpdate:function(t){var e=t.getHTML;n("input",e())}})),bubbleMenuButtons:c,floatingMenuButtons:s,openModal:function(t){r.value.showModal(t)},uploadImage:function(t){t.imageCommand(t.attrs)},dropzone:r}},beforeDestroy:function(){this.editor.destroy()}},d=Object(l.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("editor-floating-menu",{attrs:{editor:t.editor},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.commands,a=e.menu,i=e.isActive;return[n("div",{staticClass:"editor__floating-menu",class:{"is-active":a.isActive},style:"top: "+a.top+"px"},[t._l(t.floatingMenuButtons,(function(e){return n("v-tooltip",{key:e.icon,attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var r=a.on;return[n("v-btn",t._g({staticClass:"menubar__button",class:{"is-active":i[e.active](e.context)},attrs:{small:"",text:""},on:{click:function(t){o[e.command](e.context)}}},r),[n("v-icon",[t._v("mdi-"+t._s(e.icon))])],1)]}}],null,!0)},[t._v(" "),n("span",[t._v(t._s(e.tooltip))])])})),t._v(" "),n("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[n("v-btn",t._g({staticClass:"menubar__button",class:{"is-active":i.image()},attrs:{small:"",text:""},on:{click:function(e){return e.stopPropagation(),t.openModal(o.image)}}},a),[n("v-icon",[t._v("mdi-image")])],1)]}}],null,!0)},[t._v(" "),n("span",[t._v("اپلود عکس")])])],2)]}}])}),t._v(" "),n("editor-menu-bubble",{attrs:{editor:t.editor,"keep-in-bounds":!0},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.commands,a=e.menu,i=e.isActive;return[n("div",{staticClass:"menububble",class:{"is-active":a.isActive},style:"left: "+a.left+"px; bottom: "+a.bottom+"px;"},t._l(t.bubbleMenuButtons,(function(e){return n("v-btn",{key:e.icon,staticClass:"menububble__button",class:{"is-active":i[e.active](e.context)},attrs:{small:"",text:"",dark:""},on:{click:function(t){o[e.command](e.context)}}},[n("v-icon",[t._v("mdi-"+t._s(e.icon))])],1)})),1)]}}])}),t._v(" "),n("editor-content",{attrs:{editor:t.editor}}),t._v(" "),n("drop-zone",{ref:"dropzone",on:{image:t.uploadImage}})],1)}),[],!1,null,"7eaf9c30",null);e.a=d.exports},"QQ+H":function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,".editor{position:relative}.editor__floating-menu{position:absolute;z-index:1;margin-top:-.25rem;visibility:hidden;opacity:0;transition:opacity .2s,visibility .2s}.editor__floating-menu.is-active{opacity:1;visibility:visible}.editor p.is-editor-empty:first-child:before{content:attr(data-empty-text);float:right;color:#aaa;pointer-events:none;height:0;font-style:italic}",""])},fKQ9:function(t,e,n){var o=n("QQ+H");"string"==typeof o&&(o=[[t.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(o,a);o.locals&&(t.exports=o.locals)},k9I8:function(t,e,n){"use strict";n("fKQ9")}}]);